{% extends "layout.html.twig" %}

{% block title %}{{ billet.title }}{% endblock %}

{% block content %}
<p>
	<h2>{{ billet.title }}</h2>
	<p>{{ billet.content | raw }}</p>
	<div class="container">
	<h3>Commentaires</h3>
	{% block comment %}

		<div class="row">			
		{% for comment in comments %}
			<div class="col-sm-12">
				<blockquote>{{ comment.content }}
					<footer><cite>{{ comment.author}}</cite></footer>
				</blockquote>
				<div class="row">
					<div class="col-sm-2">	
						<button type ="button" class="btn btn-primary btn-xs" value="Repondre" data-toggle="collapse" data-target="#{{ comment.id }}">Repondre</button>
					</div>
					<div class="col-sm-2">
						<a href="{{ path('comment_report', { 'id': comment.id }) }}">
						<button type="button" class="btn btn-danger btn-xs" value="Signaler">Signaler</button></a>
					</div>
					<div id="{{ comment.id }}" class="col-sm-9 collapse">
						<form name="answerForm{{ comment.id }}" action="{{ path('comment_add', {'idParent': comment.id, 'billetId': billet.id}) }}" method="post">
							<div class="form-group">
								<input type="text" class="form-control" rows="4" name="answerFormPseudo{{ comment.id }}">
							</div>
							<div class="form-group">
								<textarea type="text" class="form-control" rows="4" name="answerFormContent{{ comment.id }}"></textarea>
							</div>
							<div class="form-group">
								<input type="submit" class="btn btn-primary" value="Publier">
							</div>
						</form>											
					</div>		
				</div>

				<div class="row">
				{% for childComment in comment.children %}
					<div class="col-sm-offset-1 col-sm-10">		
						<blockquote>{{ childComment.content }}
							<footer><cite>{{ childComment.author }}</cite></footer>
						</blockquote>							
						<div class="row">
							<div class="col-sm-2">	
								<button type ="button" class="btn btn-primary btn-xs" value="Repondre" data-toggle="collapse" data-target="#{{ childComment.id }}">Repondre</button>
							</div>
							<div class="col-sm-2">
								<a href="{{ path('comment_report', { 'id': childComment.id }) }}">
								<button type="button" class="btn btn-danger btn-xs" value="Signaler">Signaler</button></a>
							</div>
							
						
							<div id="{{ childComment.id }}" class="col-sm-9 collapse">
								<form name="answerForm{{ childComment.id }}" action="{{ path('comment_add', {'idParent': childComment.id, 'billetId': billet.id}) }}" method="post">
									<div class="form-group">
										<input type="text" class="form-control" rows="4" name="answerFormPseudo{{ childComment.id }}">
									</div>
									<div class="form-group">
										<textarea type="text" class="form-control" rows="4" name="answerFormContent{{ childComment.id }}"></textarea>
									</div>
									<div class="form-group">
										<input type="submit" class="btn btn-primary" value="Publier">
									</div>
								</form>	
								
								
							</div>
						</div>		
						<div class="row">	
						{% for subChildComment in childComment.children %}					
							<div class="col-sm-offset-1 col-sm-10">
								<blockquote>{{ subChildComment.content }}
									<footer><cite>{{ subChildComment.author }}</cite></footer>
								</blockquote>
							</div>	
							<div class="col-sm-2">
								<a href="{{ path('comment_report', { 'id': subChildComment.id }) }}">
								<button type="button" class="btn btn-danger btn-xs" value="Signaler">Signaler</button></a>
							</div>
	
						{% endfor %}					
						</div>
					</div>				
				{% endfor %}
				</div>		
			</div>	

		{% else %}
			Pas encore de commentaires.			
		{% endfor %}
			<div class="row">
				<div class="col-sm-4">	
					<button type ="button" class="btn btn-primary btn-xs" value="Commenter" data-toggle="collapse" data-target="#publishComment">Commenter</button>
				</div>
				

				<div id="publishComment" class="col-sm-9 collapse">							
					<form name="publishForm" action="{{ path('comment_add', {'idParent': 'null', 'billetId': billet.id}) }}" method="post">
						<div class="form-group">
							<input type="text" class="form-control" rows="4" name="publishFormPseudo">
						</div>
						<div class="form-group">
							<textarea type="text" class="form-control" rows="4" name="publishFormContent"></textarea>
						</div>
						<div class="form-group">
							<input type="submit" class="btn btn-primary" value="Publier">
						</div>
					</form>						
				</div>		
			</div>
		</div>
	{% endblock %}
	</div>
</p>
{% endblock %}
